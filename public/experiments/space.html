<!DOCTYPE html>
<html lang="en">
<head>
    <title>three.js - Arctic Text with Light Controls</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        body {
            margin: 0;
            font-family: Monospace;
            background-color: #000;
            color: #fff;
            overflow: hidden;
        }
        #controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 8px;
            z-index: 100;
        }
        .control-group {
            margin-bottom: 10px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }
        input[type="range"] {
            width: 200px;
            cursor: pointer;
        }
        .value-display {
            display: inline-block;
            margin-left: 10px;
            color: #00ffff;
            min-width: 30px;
        }
    </style>
</head>
<body>
    <div id="controls">
        <div class="control-group">
            <label>Text Size: <span class="value-display" id="sizeValue">12</span></label>
            <input type="range" id="sizeSlider" min="0.5" max="25" value="12" step="0.5">
        </div>
        <hr style="border: 0; border-top: 1px solid #444; margin: 15px 0;">
        <div class="control-group">
            <label>Light Position X: <span class="value-display" id="lightXValue">0</span></label>
            <input type="range" id="lightXSlider" min="-150" max="150" value="0" step="1">
        </div>
        <div class="control-group">
            <label>Light Position Y: <span class="value-display" id="lightYValue">10</span></label>
            <input type="range" id="lightYSlider" min="-150" max="150" value="10" step="1">
        </div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';
        import { FontLoader } from 'three/addons/loaders/FontLoader.js';

        let renderer, scene, camera, controls;
        let textMesh, font, texture;
        let lights = {};

        init();

        function init() {
            // Camera setup
            camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 100;
            camera.position.y = 20;

            // Scene setup
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a1520);

            // Create canvas for galaxy/ice texture
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 512;
            canvas.height = 512;

            // Create base gradient
            const gradient = ctx.createRadialGradient(256, 256, 0, 256, 256, 400);
            gradient.addColorStop(0, '#4a148c');
            gradient.addColorStop(0.5, '#1a237e');
            gradient.addColorStop(1, '#000000');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Stars
            for (let i = 0; i < 200; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const size = Math.random() * 2;
                ctx.fillStyle = `rgba(255, 255, 255, ${Math.random()})`;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }

            // Nebula clouds
            for (let i = 0; i < 5; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const nebula = ctx.createRadialGradient(x, y, 0, x, y, 100);
                const colors = ['rgba(138, 43, 226, 0.3)', 'rgba(75, 0, 130, 0.3)', 'rgba(255, 20, 147, 0.3)'];
                nebula.addColorStop(0, colors[i % colors.length]);
                nebula.addColorStop(1, 'rgba(0, 0, 0, 0)');
                ctx.fillStyle = nebula;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            // Create texture
            texture = new THREE.CanvasTexture(canvas);
            texture.colorSpace = THREE.SRGBColorSpace;
            texture.wrapS = THREE.RepeatWrapping;
            texture.wrapT = THREE.RepeatWrapping;
            texture.repeat.set(0.05, 0.05);

            // Setup lights
            setupLights();

            // Load font and create 3D text
            const loader = new FontLoader();
            loader.load('https://cdn.jsdelivr.net/npm/three@0.170.0/examples/fonts/helvetiker_bold.typeface.json', function(loadedFont) {
                font = loadedFont;
                createText(12);
            });

            // Renderer setup
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setAnimationLoop(animate);
            document.body.appendChild(renderer.domElement);

            // Controls
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // Handle window resize
            window.addEventListener('resize', onWindowResize);

            // Setup UI controls
            setupUIControls();
        }

        function setupLights() {
            // Ambient light
            lights.ambient = new THREE.AmbientLight(0xffffff, 0.7);
            scene.add(lights.ambient);

            // Main Directional Light (Controlled by sliders)
            lights.directional = new THREE.DirectionalLight(0xccffff, 1.5);
            // Default position (0, 10, 100)
            lights.directional.position.set(0, -20, 100); 
            scene.add(lights.directional);

            // Side highlights
            lights.point1 = new THREE.PointLight(0x00ffff, 2, 200);
            lights.point1.position.set(-30, 10, 50);
            scene.add(lights.point1);

            lights.point2 = new THREE.PointLight(0x88ccff, 2, 200);
            lights.point2.position.set(30, -10, 50);
            scene.add(lights.point2);
        }

        function createText(size) {
            if (textMesh) {
                scene.remove(textMesh);
                textMesh.geometry.dispose();
            }

            const textGeometry = new TextGeometry('Hello World!', {
                font: font,
                size: size,
                depth: size * 0.21,
                curveSegments: 12,
                bevelEnabled: true,
                bevelThickness: size * 0.14,
                bevelSize: size * 0.06,
                bevelOffset: 0,
                bevelSegments: 5
            });

            textGeometry.center();

            const textMaterial = new THREE.MeshStandardMaterial({
                map: texture,
                roughness: 0.3,
                metalness: 1,
                //emissive: 0x00ffff,   // The color of the light
                //emissiveIntensity: .02  // How b      
            });

            textMesh = new THREE.Mesh(textGeometry, textMaterial);
            scene.add(textMesh);
        }

        function setupUIControls() {
            const sizeSlider = document.getElementById('sizeSlider');
            const sizeValue = document.getElementById('sizeValue');
            
            // Light control elements
            const lightXSlider = document.getElementById('lightXSlider');
            const lightXValue = document.getElementById('lightXValue');
            const lightYSlider = document.getElementById('lightYSlider');
            const lightYValue = document.getElementById('lightYValue');

            sizeSlider.addEventListener('input', (e) => {
                const size = parseFloat(e.target.value);
                sizeValue.textContent = size;
                if (font) createText(size);
            });

            lightXSlider.addEventListener('input', (e) => {
                const val = parseFloat(e.target.value);
                lightXValue.textContent = val;
                lights.directional.position.x = val;
            });

            lightYSlider.addEventListener('input', (e) => {
                const val = parseFloat(e.target.value);
                lightYValue.textContent = val;
                lights.directional.position.y = val;
            });
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            controls.update();
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>